<!DOCTYPE html>
<html>
<head>
    <style>
        body { margin: 0; overflow: hidden; background: transparent; }
        model-viewer {
            width: 100vw; height: 100vh;
            background-color: transparent;
            position: absolute;
            bottom: -80px; /* 腕の付け根を隠すために少し下げる */
            right: -30px;
            transition: transform 0.1s ease-out; /* 動きをなめらかに */
        }
    </style>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>
</head>
<body>
    <model-viewer 
        id="weapon"
        src="melee_156.glb" 
        autoplay
        animation-name="Idle"  /* 初期状態は待機ポーズ */
        camera-orbit="45deg 75deg 10m" 
        interaction-prompt="none">
    </model-viewer>

    <script>
        const mv = document.querySelector('#weapon');

        window.addEventListener('message', (e) => {
            if (e.data.type === 'mousemove') {
                // 慣性のある動き
                mv.style.transform = `translate(${e.data.x * 30}px, ${e.data.y * 20}px) rotate(${e.data.x * 5}deg)`;
            }

            if (e.data.type === 'action') {
                // 特定のアニメーションに切り替え
                mv.animationName = e.data.animation;
                
                // アニメーションが終わったらIdleに戻す（例：1秒後）
                setTimeout(() => {
                    mv.animationName = "Idle";
                }, 1000); 
            }
        });
    </script>
</body>
</html>
